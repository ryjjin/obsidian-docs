# Obsidian for Android

Android版アプリは現在[[ベータ版モバイルアプリ|クローズベータ]]であり、署名付きAPKとして利用可能です。

## データを同期するにはどうすればよいですか？

Android版Obsidianではデバイス上のパブリックドキュメントフォルダ内に存在するすべての保管庫をローカルに保存しています。ファイルを同期するために[[Obsidian Sync]]を利用するか、パブリックドキュメントフォルダと同期することが可能な他のサードパーティ同期サービス提供者を利用するかを選択することができます。

### Obsidian Syncによる同期

デスクトップ版Obsidianと同様に、モバイル版でもビルトインの[[Obsidian Sync]]による有料同期サービスを提供しています。

Obsidian Syncを介して同期される保管庫のセットアップを行うには、まず空のローカル保管庫を新規作成してください。空の保管庫を開いたら左のサイドバーを展開し、設定ボタンをクリックしてください。デスクトップ版で行ったように次の手順でObsidian Syncの設定を行ってください。

1. アカウントタブからObsidianのアカウントにログイン
2. 同期のコアプラグインを有効化
3. 同期するリモート保管庫を選択
4. 全ファイルが同期完了するまでアプリを開いたままの状態にする

Obsidian Syncの同期ステータスを閲覧するためには、スワイプして右のドロワーを引き出すことで、デスクトップ版と同様に同期ステータスのインディケータを閲覧できます。デバッグを行うため同期ログ等の詳細情報を得たい場合には、インジケーターをタップしてください。

ノート: サードパーティの同期サービスと一緒にObsidian Syncを利用している場合には、Obsidian Syncに支障が起きないようサードパーティの同期サービスから`.obsidian/sync.json`の同期を除外するようにしてください。このファイルはローカルデバイスの同期ステータスを追跡するために使用されており、予期せず同期されてしまった場合には問題を引き起こす可能性があります。

### サードパーティの同期サービスによる同期

端末内部のローカルフォルダを他のデバイスと同期させるために好きな同期方法を使用することができます。

携帯端末と他のデバイス間でのフォルダ同期を行うためのアプリをPlayストア上で見つけることができます。例えば、[Dropsync](https://play.google.com/store/apps/details?id=com.ttxapps.dropsync)や[FolderSync](https://play.google.com/store/apps/details?id=dk.tacit.android.foldersync.lite)などのアプリがあります。

しかしながら、これらの同期方法が確実に同期できるかどうかのテストは行っていません。これらのアプリによって同期に成功したり利用経験がある場合には、このページに追記できるように情報をお知らせください。

## 保管庫はどこに保存されますか？

AndroidではObsidianのホームフォルダは`Documents/Obsidian`の下にあるパブリックドキュメントフォルダに保存されています。パブリックの`Documents`フォルダは通常、SDカードもしくはエミュレートされたストレージに保存されています。

このホームフォルダ内のいかなるフォルダも保管庫として認識されます。このディレクトリ内に保管庫を同期またはコピーする場合には、Obsidianを開いた際に認識可能となります。

# Obsidian for iOS

iOS版アプリは現在[[Obsidianモバイル|クローズベータ]]であり、TestFlightにて利用可能です。

## データを同期するにはどうすればよいですか？

iOS版ObsidianではiCloudかローカルに保管庫を保存できます。テストが実施された上で現在推奨している同期方法はiCloudとObsidian Syncの2つです。

デバイス上の特定フォルダをバックグラウンドで同期が可能なサードパーティの同期サービスプロバイダーであれば、2つの同期方法と同様に上手く機能するはずですが、あらゆるサービスが実際に機能するかどうかについては認識していません。これはiOSアプリ間でのファイル共有が高度に複雑な仕組みとなっており、その制約があるためです。すべてのアプリがアクセス可能なパブリックフォルダを提供しているAndroidの場合とは異なります。このため、多くのサードパーティの同期サービスプロバイダーはiOSでのバックグラウンド同期に関する適切な実装を行っていません。

### Obsidian Syncによる同期

下に示したように、Androidでの同期と同様のステップに従うことで同期できます。現在、Obsidian Syncによる同期とiCloudによる同期の両方を同時に使用することは推奨していません。同時使用によって競合状態によるデータ損失の発生が報告されています。

![[#Obsidian for Android#Obsidian Syncによる同期]]

### iCloud Driveによる同期

iCloud Driveを介した同期のセットアップを行うには、まずはObsidianのiOSアプリをインストールする必要があります。これによってiCloud Driveの下に"Obsidian"という名前のフォルダがObsidianのアプリロゴとともに作成されます。このフォルダはiCloudから特殊フォルダとして認識されるため、iCloud Drive内部に手動で作成する場合のフォルダとは異なることに注意してください。

次に、コンピュータ上で保管庫のフォルダを`iCloud Drive/Obsidian/`に移動させてください。これによってObsidianがiCloud Drive内の特殊アプリフォルダを読み込みできるようになります。

保管庫フォルダ全体をiCloudで同期させたらモバイルデバイス上でObsidianのアプリを開いてください。iCloudで保存されていることを示すクラウドアイコンと共に移動させた保管庫の閲覧が可能になります。

初めて保管庫を開いた際には、iCloudがバックグラウンドですべてのファイルをダウンロードするためにObsidianがしばらくの間フリーズしているように見えるかもしれません。iCloudが一旦すべての同期を完了すれば、アプリはスムーズに動作するはずです。うまく行かない場合には何度かアプリを再起動する必要があるかもしれません。

### Working Copy

iOSでの代替手段として、保管庫の同期を行うためにWorking CopyをセットアップしてGitを利用することも可能です。これを行うためには、まず最初にデバイス上に空のローカル保管庫を作成し、｢フォルダー同期のセットアップ｣を行った後にObsidianのアプリ内部でローカル保管庫を選択してください。これによって、手動でのコミットとプッシュが可能になります。

## 保管庫はどこに保存されますか？

iCloudで保管庫の保存を行う場合には、保管庫のデータは"Obsidian"という名前のアプリケーションフォルダの直下にあるiCloud Driveアカウント内コンテナに保存されることになります。アプリケーションフォルダはObsidianのロゴアイコンで表示されています。

iCloudでの同期を行わない場合には、保管庫はObsidianアプリのサンドボックスファイルシステムに保存されます。現在、v0.0.14の時点ではローカル保管庫はファイルシステムを介したフォルダ選択をサポートしている他のアプリからアクセスできます。Working Copyのようなアプリはそれ自体として、Obsidianのローカル保管庫の同期に使用できます。

現在、ObsidianはFileProviderを介して仮想ファイルシステムを提供するサードパーティの同期サービスプロバイダーに対しての直接的なサポートは行っていません。

# サードパーティの同期サービスへのサポート

モバイル版Obsidianではなぜ他の同期方法をサポートしていないのかと多くのユーザーから質問されますが、現在のモバイル同期サポートの状況に対する簡単な説明をここに記載しておきます。

Obsidianが1WriterやiA Writerといった他のアプリと異なる部分の一つとしては、単一のノートというよりはむしろ保管庫のトップで機能するということが挙げられます。オートコンプリートや画像埋め込み、タグペイン、バックリンク、そしてすべてのノート間機能などのObsidianが有するコア機能の多くは、保管庫全体とその内部に存在するすべてのファイルに依存しているからです。

対照的に、多くのマークダウン編集アプリは単純に単一のノートを**開き**、ユーザーに編集させ、ノートをバックグラウンドで保存するような仕組みになっています。これによって、OSとサードパーティの同期サービスプロバイダーは通常、保管庫(サブフォルダを持ちうるフォルダやファイル群)を扱うというよりはむしろ、単一ファイルに対してのアクセスや作業のためのAPIを提供するのみとなっています。

標準的なマークダウンエディタのアプリでは、同期のために**選択したファイルを開いた際にファイルをダウンロード**と**保存を行った際にファイルをアップロードして戻す**という基本機能を実装しているのみとなっています。Obsidianでは利便性と共に、変更があった全ファイル(例えば、ファイルのリネームを実行した際には、他のファイルに存在するリンク名が変更されるためにそれら一連のファイルを更新するなどの可能性があります)に対しての追跡を維持するため、保管庫全体をダウンロードする必要があります。その上で、同期ソリューションを介して変更を監視し、ファイル変更の際には内部キャッシュを更新して正確なリンクを提供する方法が必要となってきます。

それらすべてをサードパーティの同期サービスプロバイダーが維持するというのは、かなり大変です。これが、多くの同期サービスプロバイダーがモバイル用に適切な同期クライアントを開発せず、ユーザーがサードパーティのアプリ(DropSyncやFolderSyncなど)を使用しているという事の理由の一つとなっています。残念ながら、iOSではそのようなアプリはサンドボックスがあるために存在しえないのです。
